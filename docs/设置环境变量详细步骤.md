# 设置环境变量详细步骤（图文说明）

## 重要提示

⚠️ **必须在仓库级别设置，不是在 Environment 级别！**

你当前看到的是 **Environment** 的设置页面（`github-pages` 环境），但我们需要在**仓库级别**设置变量。

## 正确步骤

### 步骤 1: 返回到仓库设置主页

1. 在浏览器地址栏，你应该看到类似这样的 URL：
   ```
   https://github.com/chengms/HistoricalThreads/settings/environments/github-pages
   ```

2. 修改 URL，去掉 `/environments/github-pages` 部分，变成：
   ```
   https://github.com/chengms/HistoricalThreads/settings
   ```
   或者直接点击左侧菜单的 **Settings**（最顶部）

### 步骤 2: 进入 Secrets and variables > Actions

1. 在左侧菜单中找到 **Secrets and variables**
2. 点击展开，你会看到：
   - **Actions** ← 点击这个
   - **Dependabot**（如果有）

### 步骤 3: 点击 Variables 标签页

1. 进入 Actions 页面后，你会看到两个标签页：
   - **Secrets** 标签页（用于敏感信息）
   - **Variables** 标签页（用于非敏感配置）← **点击这个**

### 步骤 4: 添加新变量

1. 点击 **New repository variable** 按钮
2. 填写：
   - **Name**: `VITE_USE_CUSTOM_DOMAIN`
   - **Value**: `true`
3. 点击 **Add variable**

## 完整路径导航

```
仓库主页
  └─ Settings（设置）
      └─ Secrets and variables（左侧菜单）
          └─ Actions
              └─ Variables（标签页）← 在这里添加
```

## 区别说明

### ❌ 错误位置：Environment Variables
- 路径：`Settings > Environments > github-pages > Environment variables`
- 这是**环境级别**的变量，只在该特定环境（`github-pages`）中可用
- 我们的 workflow 使用的是**仓库级别**的变量

### ✅ 正确位置：Repository Variables
- 路径：`Settings > Secrets and variables > Actions > Variables`
- 这是**仓库级别**的变量，在所有 workflow 中可用
- 我们的 workflow 使用 `${{ vars.VITE_USE_CUSTOM_DOMAIN }}` 来访问

## 验证设置

设置完成后，你可以：

1. 在 Variables 列表中看到 `VITE_USE_CUSTOM_DOMAIN` 变量
2. 重新触发部署（推送代码或手动触发 workflow）
3. 在 Actions 的构建日志中，应该能看到环境变量被正确传递

## 如果仍然找不到

如果按照上述步骤仍然找不到，可以：

1. **直接访问 URL**：
   ```
   https://github.com/chengms/HistoricalThreads/settings/secrets/actions
   ```

2. **或者**：
   - 访问仓库主页
   - 点击顶部的 **Settings** 标签
   - 在左侧菜单中查找 **Secrets and variables** > **Actions**

## 截图参考

正确的页面应该显示：
- 标题：**Repository variables**
- 描述：Variables are used for non-sensitive configuration data...
- 有一个 **New repository variable** 按钮
- 列表显示所有已设置的变量（如果之前有设置过）

