# åŽ†å²æ•°æ®è‡ªåŠ¨çˆ¬è™«ç³»ç»Ÿ

è‡ªåŠ¨å‘çŽ°ã€çˆ¬å–ã€å®¡æ ¸å¹¶ä¿å­˜åŽ†å²äº‹ä»¶å’Œäººç‰©ä¿¡æ¯çš„æ™ºèƒ½çˆ¬è™«ç³»ç»Ÿã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ðŸ¤– **AI è‡ªåŠ¨å‘çŽ°**ï¼šä½¿ç”¨ OpenAI API è‡ªåŠ¨å‘çŽ°åŽ†å²äººç‰©å’Œäº‹ä»¶
- ðŸ“¥ **å¤šæºçˆ¬å–**ï¼šæ”¯æŒç™¾åº¦ç™¾ç§‘ã€ç»´åŸºç™¾ç§‘ç­‰å¤šä¸ªæ•°æ®æº
- ðŸ–¼ï¸ **å›¾ç‰‡ä¸‹è½½**ï¼šè‡ªåŠ¨ä¸‹è½½äººç‰©ç…§ç‰‡å¹¶ä¿å­˜
- âœ… **AI å®¡æ ¸**ï¼šä½¿ç”¨ AI éªŒè¯å†…å®¹å‡†ç¡®æ€§å’Œäººç‰©-äº‹ä»¶å…³è”
- ðŸ”„ **æ™ºèƒ½åŽ»é‡**ï¼šè‡ªåŠ¨è·³è¿‡å·²å­˜åœ¨çš„æ•°æ®
- ðŸ“Š **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒæŒ‰æœä»£æ‰¹é‡çˆ¬å–

## ðŸ“‹ å‰ç½®è¦æ±‚

1. **Node.js** >= 18.0.0
2. **AI API Key**ï¼ˆå¯é€‰ï¼Œç”¨äºŽ AI åŠŸèƒ½ï¼‰
   - **Kimi (Moonshot AI)** - æŽ¨èï¼šhttps://platform.moonshot.cn/
   - **OpenAI**ï¼šhttps://platform.openai.com/api-keys
   - å¦‚æžœæ²¡æœ‰ API Keyï¼Œç³»ç»Ÿä¼šä½¿ç”¨é»˜è®¤åˆ—è¡¨

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd scripts/crawler
npm install
```

### 2. é…ç½®çŽ¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env`ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ AI API Keyï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š

**é€‰é¡¹ 1: ä½¿ç”¨ Kimi (Moonshot AI) - æŽ¨è**
```env
KIMI_API_KEY=your-kimi-api-key-here
KIMI_MODEL=moonshot-v1-8k
```

**é€‰é¡¹ 2: ä½¿ç”¨ OpenAI**
```env
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_MODEL=gpt-4
```

**æ³¨æ„**ï¼š
- å¦‚æžœæ²¡æœ‰ AI API Keyï¼Œç³»ç»Ÿä»å¯è¿è¡Œï¼Œä½†ä¼šä½¿ç”¨é»˜è®¤çš„äººç‰©å’Œäº‹ä»¶åˆ—è¡¨
- Kimi API é€šå¸¸æ¯” OpenAI æ›´ä¾¿å®œï¼ŒæŽ¨èä½¿ç”¨

### 3. è¿è¡Œè‡ªåŠ¨çˆ¬è™«

```bash
# ä½¿ç”¨é»˜è®¤æœä»£ï¼ˆæ±‰æœã€å”æœã€å®‹æœã€æ˜Žæœã€æ¸…æœï¼‰
npm start

# æˆ–æŒ‡å®šæœä»£
npm start æ±‰æœ å”æœ

# æˆ–ä½¿ç”¨ auto å‘½ä»¤
npm run auto å®‹æœ å…ƒæœ
```

## ðŸ“– ä½¿ç”¨æ–¹æ³•

### è‡ªåŠ¨çˆ¬å–ï¼ˆæŽ¨èï¼‰

è‡ªåŠ¨å‘çŽ°å¹¶çˆ¬å–æŒ‡å®šæœä»£çš„åŽ†å²æ•°æ®ï¼š

```bash
npm start [æœä»£1] [æœä»£2] ...
```

ç¤ºä¾‹ï¼š
```bash
# çˆ¬å–æ±‰æœå’Œå”æœçš„æ•°æ®
npm start æ±‰æœ å”æœ

# çˆ¬å–æ‰€æœ‰é»˜è®¤æœä»£
npm start
```

### æ‰‹åŠ¨çˆ¬å–äººç‰©

```bash
npm run crawl-persons äººç‰©åç§°1 äººç‰©åç§°2 ...
```

ç¤ºä¾‹ï¼š
```bash
npm run crawl-persons æ±‰æ­¦å¸ å”å¤ªå®— å®‹å¤ªç¥–
```

### æ‰‹åŠ¨çˆ¬å–äº‹ä»¶

```bash
npm run crawl-events äº‹ä»¶åç§°1 äº‹ä»¶åç§°2 ...
```

ç¤ºä¾‹ï¼š
```bash
npm run crawl-events èµ¤å£ä¹‹æˆ˜ å®‰å²ä¹‹ä¹± éƒ‘å’Œä¸‹è¥¿æ´‹
```

## ðŸ”§ é…ç½®è¯´æ˜Ž

### çŽ¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜Ž | å¿…éœ€ |
|--------|------|------|
| `OPENAI_API_KEY` | OpenAI API å¯†é’¥ | å¦ï¼ˆç”¨äºŽ AI åŠŸèƒ½ï¼‰ |
| `MAX_PERSONS_PER_DYNASTY` | æ¯ä¸ªæœä»£æœ€å¤šçˆ¬å–çš„äººç‰©æ•° | å¦ï¼ˆé»˜è®¤ 20ï¼‰ |
| `MAX_EVENTS_PER_DYNASTY` | æ¯ä¸ªæœä»£æœ€å¤šçˆ¬å–çš„äº‹ä»¶æ•° | å¦ï¼ˆé»˜è®¤ 15ï¼‰ |
| `RATE_LIMIT_MS` | è¯·æ±‚é—´éš”ï¼ˆæ¯«ç§’ï¼‰ | å¦ï¼ˆé»˜è®¤ 2000ï¼‰ |

### æ•°æ®æºé…ç½®

ç¼–è¾‘ `config/sources.json` å¯ä»¥é…ç½®æ•°æ®æºï¼š

```json
{
  "personSources": [
    {
      "name": "ç™¾åº¦ç™¾ç§‘",
      "enabled": true,
      "rateLimit": 2000
    },
    {
      "name": "ç»´åŸºç™¾ç§‘",
      "enabled": true,
      "rateLimit": 2000
    }
  ]
}
```

## ðŸ¤– AI åŠŸèƒ½

### è‡ªåŠ¨å‘çŽ°

ç³»ç»Ÿä½¿ç”¨ OpenAI GPT-4 è‡ªåŠ¨å‘çŽ°åŽ†å²äººç‰©å’Œäº‹ä»¶ï¼š

- **äººç‰©å‘çŽ°**ï¼šæ ¹æ®æœä»£è‡ªåŠ¨ç”Ÿæˆé‡è¦äººç‰©åˆ—è¡¨
- **äº‹ä»¶å‘çŽ°**ï¼šæ ¹æ®æœä»£è‡ªåŠ¨ç”Ÿæˆé‡è¦äº‹ä»¶åˆ—è¡¨
- **æ™ºèƒ½åˆ†ç±»**ï¼šè‡ªåŠ¨è¯†åˆ«äººç‰©ç±»åž‹ï¼ˆæ”¿æ²»ã€å†›äº‹ã€æ–‡åŒ–ç­‰ï¼‰

### AI å®¡æ ¸

æ‰€æœ‰çˆ¬å–çš„æ•°æ®éƒ½ä¼šç»è¿‡ AI å®¡æ ¸ï¼š

1. **äººç‰©ä¿¡æ¯å®¡æ ¸**ï¼š
   - éªŒè¯ç”Ÿå’å¹´ä»½æ˜¯å¦åˆç†
   - æ£€æŸ¥æœä»£å½’å±žæ˜¯å¦æ­£ç¡®
   - éªŒè¯ç®€ä»‹å†…å®¹å‡†ç¡®æ€§

2. **äº‹ä»¶ä¿¡æ¯å®¡æ ¸**ï¼š
   - éªŒè¯æ—¶é—´æ˜¯å¦åˆç†
   - æ£€æŸ¥åœ°ç‚¹æ˜¯å¦æ­£ç¡®
   - éªŒè¯äº‹ä»¶æè¿°å‡†ç¡®æ€§
   - æ£€æŸ¥ç›¸å…³äººç‰©æ˜¯å¦åˆç†

3. **å…³è”éªŒè¯**ï¼š
   - éªŒè¯äººç‰©ä¸Žäº‹ä»¶çš„å…³è”æ€§
   - æ£€æŸ¥æ—¶é—´çº¿ä¸€è‡´æ€§

### ç½®ä¿¡åº¦é˜ˆå€¼

- **é«˜ç½®ä¿¡åº¦** (>= 0.8)ï¼šç›´æŽ¥é€šè¿‡
- **ä¸­ç½®ä¿¡åº¦** (0.5-0.8)ï¼šé€šè¿‡ä½†æ ‡è®°è­¦å‘Š
- **ä½Žç½®ä¿¡åº¦** (< 0.5)ï¼šæ‹’ç»ä¿å­˜

## ðŸ“ è¾“å‡ºæ–‡ä»¶

çˆ¬å–çš„æ•°æ®ä¼šä¿å­˜åˆ°ï¼š

- **äººç‰©æ•°æ®**ï¼š`frontend/public/data/persons.json`
- **äº‹ä»¶æ•°æ®**ï¼š`frontend/public/data/events.json`
- **äººç‰©å›¾ç‰‡**ï¼š`frontend/public/images/persons/`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éµå®ˆç½‘ç«™åè®®**ï¼š
   - éµå®ˆ robots.txt åè®®
   - è®¾ç½®åˆç†çš„è¯·æ±‚é—´éš”ï¼ˆé»˜è®¤ 2 ç§’ï¼‰
   - ä¸è¦è¿‡åº¦è¯·æ±‚ï¼Œé¿å…è¢«å° IP

2. **API ä½¿ç”¨**ï¼š
   - OpenAI API ä¼šäº§ç”Ÿè´¹ç”¨
   - å»ºè®®è®¾ç½®ä½¿ç”¨é™é¢
   - ç›‘æŽ§ API ä½¿ç”¨æƒ…å†µ

3. **æ•°æ®å‡†ç¡®æ€§**ï¼š
   - AI å®¡æ ¸ä»…ä¾›å‚è€ƒï¼Œå»ºè®®äººå·¥å¤æ ¸
   - é‡è¦æ•°æ®å»ºè®®å¤šæºéªŒè¯
   - å®šæœŸæ›´æ–°å’Œä¿®æ­£æ•°æ®

4. **ç½‘ç»œçŽ¯å¢ƒ**ï¼š
   - ç¡®ä¿å¯ä»¥è®¿é—®ç™¾åº¦ç™¾ç§‘å’Œç»´åŸºç™¾ç§‘
   - å¦‚æžœç½‘ç»œå—é™ï¼Œå¯èƒ½éœ€è¦ä»£ç†

## ðŸ› æ•…éšœæŽ’æŸ¥

### é—®é¢˜ 1: OpenAI API é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š`OpenAI API Key æœªé…ç½®` æˆ– `API è°ƒç”¨å¤±è´¥`

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ API Key æœ‰æ•ˆä¸”æœ‰è¶³å¤Ÿé¢åº¦
3. å¦‚æžœæ²¡æœ‰ API Keyï¼Œç³»ç»Ÿä¼šä½¿ç”¨é»˜è®¤åˆ—è¡¨ç»§ç»­è¿è¡Œ

### é—®é¢˜ 2: ç½‘ç»œè¯·æ±‚å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`èŽ·å–é¡µé¢å¤±è´¥` æˆ– `è¯·æ±‚è¶…æ—¶`

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
2. å¢žåŠ  `RATE_LIMIT_MS` å»¶è¿Ÿæ—¶é—´
3. æ£€æŸ¥æ˜¯å¦éœ€è¦ä»£ç†

### é—®é¢˜ 3: å›¾ç‰‡ä¸‹è½½å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`å›¾ç‰‡ä¸‹è½½å¤±è´¥`

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `frontend/public/images/persons` ç›®å½•æƒé™
2. ç¡®è®¤æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
3. æ£€æŸ¥å›¾ç‰‡ URL æ˜¯å¦æœ‰æ•ˆ

### é—®é¢˜ 4: æ•°æ®æ ¼å¼é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š`JSON è§£æžå¤±è´¥`

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦æŸå
2. å¤‡ä»½åŽé‡æ–°çˆ¬å–
3. æ£€æŸ¥ AI è¿”å›žçš„ JSON æ ¼å¼

## ðŸ“Š è¿è¡Œç¤ºä¾‹

```bash
$ npm start æ±‰æœ

ðŸš€ è‡ªåŠ¨åŽ†å²æ•°æ®çˆ¬è™«å¯åŠ¨
============================================================
ðŸ“‹ è®¡åˆ’å¤„ç†æœä»£: æ±‰æœ
============================================================

============================================================
ðŸ›ï¸  å¼€å§‹å¤„ç†æœä»£: æ±‰æœ
============================================================

ðŸ” è‡ªåŠ¨å‘çŽ° æ±‰æœ æ—¶æœŸçš„é‡è¦äººç‰©...
âœ… å‘çŽ° 15 ä¸ªäººç‰©
   1. æ±‰æ­¦å¸ (politician, high)
   2. æ±‰é«˜ç¥– (politician, high)
   3. å¼ éªž (cultural, high)
   ...

ðŸ“¥ å¼€å§‹çˆ¬å– 12 ä¸ªæ–°äººç‰©...

[1/12] å¤„ç†: æ±‰æ­¦å¸
ðŸ“¥ å¼€å§‹çˆ¬å–äººç‰©: æ±‰æ­¦å¸
âœ… ä»Ž baidu æˆåŠŸèŽ·å–æ•°æ®
ðŸ¤– å¼€å§‹ AI å®¡æ ¸...
âœ… AI å®¡æ ¸é€šè¿‡ (ç½®ä¿¡åº¦: 0.95)
ðŸ“· å°è¯•ä¸‹è½½å›¾ç‰‡...
âœ… å›¾ç‰‡ä¸‹è½½æˆåŠŸ: æ±‰æ­¦å¸.jpg
âœ… æ±‰æ­¦å¸ å¤„ç†å®Œæˆ

...

âœ… æˆåŠŸä¿å­˜ 12 ä¸ªäººç‰©ä¿¡æ¯
âœ… æˆåŠŸä¿å­˜ 8 ä¸ªäº‹ä»¶ä¿¡æ¯

============================================================
ðŸ“Š çˆ¬å–æ€»ç»“
============================================================
âœ… æ€»å…±çˆ¬å–äººç‰©: 12 ä¸ª
âœ… æ€»å…±çˆ¬å–äº‹ä»¶: 8 ä¸ª
============================================================

ðŸŽ‰ æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼
```

## ðŸ”— ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®ä¸» README](../../README.md)
- [æ•°æ®æ ¼å¼è¯´æ˜Ž](../../docs/æ•°æ®æ•´ç†è¯´æ˜Ž.md)
- [API å®‰å…¨æœ€ä½³å®žè·µ](../../docs/APIå®‰å…¨æœ€ä½³å®žè·µ.md)

## ðŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0
- âœ… å®žçŽ°è‡ªåŠ¨å‘çŽ°åŠŸèƒ½
- âœ… å®žçŽ°å¤šæºçˆ¬å–
- âœ… å®žçŽ° AI å®¡æ ¸
- âœ… å®žçŽ°å›¾ç‰‡è‡ªåŠ¨ä¸‹è½½
- âœ… æ”¯æŒæ‰¹é‡å¤„ç†

## ðŸ¤ è´¡çŒ®

æ¬¢è¿Žæäº¤ Issue å’Œ Pull Requestï¼

## ðŸ“„ è®¸å¯è¯

MIT License
